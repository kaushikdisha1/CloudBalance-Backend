# ============================================
# CloudBalance Backend - Application Configuration
# 100% PRD Compliant
# ============================================

# Application Info
spring.application.name=cloudBalanceBackend
server.port=8080

# ============================================
# Database Configuration
# ============================================
spring.datasource.url=jdbc:mysql://localhost:3306/cloudBalanceData?useSSL=false&allowPublicKeyRetrieval=true
spring.datasource.username=${DB_USERNAME:disha}
spring.datasource.password=${DB_PASSWORD:MyStrong@123}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA / Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# ============================================
# JWT Configuration
# ??  CHANGE JWT_SECRET IN PRODUCTION!
# ============================================
app.jwt.secret=${JWT_SECRET:change_this_to_a_strong_secret_must_be_long_>=32_chars_for_production_security}
app.jwt.expiration-minutes=${JWT_EXPIRATION_MINUTES:15}

# ============================================
# RabbitMQ Configuration
# ? Auto-startup ENABLED for CSV processing
# ============================================
spring.rabbitmq.host=${RABBITMQ_HOST:localhost}
spring.rabbitmq.port=${RABBITMQ_PORT:5672}
spring.rabbitmq.username=${RABBITMQ_USERNAME:guest}
spring.rabbitmq.password=${RABBITMQ_PASSWORD:guest}
spring.rabbitmq.listener.simple.auto-startup=true
spring.rabbitmq.listener.simple.retry.enabled=true
spring.rabbitmq.listener.simple.retry.max-attempts=3

# ============================================
# Snowflake Configuration
# Leave empty to use dummy data during development
# ============================================
snowflake.url=${SNOWFLAKE_URL:}
snowflake.user=${SNOWFLAKE_USER:}
snowflake.password=${SNOWFLAKE_PASSWORD:}
snowflake.database=${SNOWFLAKE_DATABASE:}
snowflake.schema=${SNOWFLAKE_SCHEMA:PUBLIC}
snowflake.warehouse=${SNOWFLAKE_WAREHOUSE:}

# ============================================
# AWS Configuration
# ============================================
aws.region=${AWS_REGION:us-east-1}
# Enable AssumeRole for cross-account access
aws.assume-role.enabled=${AWS_ASSUME_ROLE_ENABLED:false}
# Template: arn:aws:iam::{accountId}:role/CloudBalanceAccessRole
aws.assume-role.role-arn-template=${AWS_ROLE_ARN_TEMPLATE:}

# ============================================
# Logging Configuration
# ============================================
# Console Logging
logging.level.root=INFO
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=INFO
logging.level.com.example.cloudBalanceBackend=INFO
logging.level.org.hibernate.SQL=INFO
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=INFO

# File Logging
logging.file.name=logs/cloudbalance.log
logging.file.max-size=10MB
logging.file.max-history=30
logging.file.total-size-cap=100MB

# Log Pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ============================================
# Server Configuration
# ============================================
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=never
server.error.include-exception=false

# ============================================
# Actuator Configuration (for health checks)
# ============================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized

# ============================================
# Development vs Production
# ============================================
# For production, use environment-specific profiles:
# spring.profiles.active=prod
# And create application-prod.properties with:
# - spring.jpa.hibernate.ddl-auto=validate
# - spring.jpa.show-sql=false
# - logging.level.root=WARN